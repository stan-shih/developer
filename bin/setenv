#!/bin/bash
#### ==========================================================================
export DEV_HOME="$(cd "$(dirname $(readlink -f "${BASH_SOURCE[0]}"))/.." && pwd)"
#### ==========================================================================
export DEV_ENV_ARCH=$(echo $MACHTYPE|awk -F- '{print $1}')
export DEV_ENV_MACH=$(echo $MACHTYPE|awk -F- '{print $2}')
export DEV_ENV_OS=$(echo $MACHTYPE|awk -F- '{print $3}')
#### ==========================================================================
if [ "$1" == '' ]; then
    export DEV_BASE=developer
else
    export DEV_BASE=$1
fi
export BASE=$DEV_HOME/home/$DEV_BASE
if [ ! -d $BASE ]; then
    mkdir -p $BASE
    echo "Create base directory in the home ($BASE)."
    echo "Please setup java and eclipse"
fi
#### ==========================================================================
if [[ ! "$PATH" =~ $DEV_HOME/bin ]]; then
    export PATH=$DEV_HOME/bin:$PATH
fi
#### ==========================================================================
export JAVA_HOME=$BASE/java
if [[ ! "$PATH" =~ $JAVA_HOME/bin ]]; then
    export PATH=$PATH:$JAVA_HOME/bin
fi
#### ==========================================================================
export ECLIPSE_HOME=$BASE/eclipse
if [[ ! "$PATH" =~ $ECLIPSE_HOME ]]; then
    export PATH=$PATH:$ECLIPSE_HOME
fi
#### ==========================================================================
. userinfo
#### ==========================================================================
if [ ! -f ~/.ssh/id_rsa.pub ]; then
    echo "SSH Key does not exist, creating new one in ~/.ssh"
    ssh-keygen -q -t rsa -N "" -f ~/.ssh/id_rsa
fi
#### ==========================================================================
# Setup Git Bash Support Cmd Charset
cmd //C "chcp 65001"
#### ==========================================================================
PS1='\[\033]0;$TITLEPREFIX:$PWD\007\]' # set window title
PS1="$PS1"'\n'                 # new line
PS1="$PS1"'\[\033[32m\]'       # change to green
PS1="$PS1"'\u@\h '             # user@host<space>
PS1="$PS1"'\[\033[35m\]'       # change to purple
PS1="$PS1"'$MSYSTEM '          # show MSYSTEM
PS1="$PS1"'\[\033[33m\]'       # change to brownish yellow
PS1="$PS1"'\w'                 # current working directory
if test -z "$WINELOADERNOEXEC"
then
    GIT_EXEC_PATH="$(git --exec-path 2>/dev/null)"
    COMPLETION_PATH="${GIT_EXEC_PATH%/libexec/git-core}"
    COMPLETION_PATH="${COMPLETION_PATH%/lib/git-core}"
    COMPLETION_PATH="$COMPLETION_PATH/share/git/completion"
    if test -f "$COMPLETION_PATH/git-prompt.sh"
    then
        . "$COMPLETION_PATH/git-completion.bash"
        . "$COMPLETION_PATH/git-prompt.sh"
        PS1="$PS1"'\[\033[36m\]'  # change color to cyan
        PS1="$PS1"'`__git_ps1`'   # bash function
    fi
fi
PS1="$PS1"'\[\033[0m\]'        # change color
PS1="$PS1"' $DEV_BASE\n'       # new line
PS1="$PS1"'$ '                 # prompt: always $
#### ==========================================================================
devenv
